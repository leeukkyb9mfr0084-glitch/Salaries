### Kranos Reporter: Application Specifications
*Version 3.0 - Last Updated: June 15, 2025*

#### 1. Overview
This document outlines the complete functional and technical specifications for the Kranos Reporter application. The application is an internal tool designed to manage members and service plans. It also creates membership transactions to track payments and provide essential financial and renewal reporting.

#### 2. Database Schema
The application will use a simplified SQLite database with the following three core tables:

**`members` table:** (Based on whiteboard design)
* `id` (INTEGER, Primary Key)
* `name` (TEXT, Mandatory)
* `phone` (TEXT, Mandatory, Unique)
* `email` (TEXT)
* `join_date` (TEXT)
* `is_active` (BOOLEAN)

**`plans` table:** (Based on whiteboard design)
* `id` (INTEGER, Primary Key)
* `name` (TEXT, Mandatory)
* `duration_days` (INTEGER, Mandatory)
* `default_amount` (REAL, Mandatory)
* `display_name` (TEXT, Unique)
* `is_active` (BOOLEAN)

**`memberships` table:** (Retained for reporting)
* `id` (INTEGER, Primary Key)
* `member_id` (INTEGER, Foreign Key to `members.id`)
* `plan_id` (INTEGER, Foreign Key to `plans.id`)
* `start_date` (TEXT)
* `end_date` (TEXT)
* `amount_paid` (REAL)
* `purchase_date` (TEXT)
* `membership_type` (TEXT: 'New' or 'Renewal')
* `is_active` (BOOLEAN)

#### 3. Functional Specifications by Tab

The application will feature four primary tabs as depicted in the whiteboard navigation.

**Members Tab**
This tab follows the whiteboard design for member management.

* **Left Panel: Create / Update Member**
    * **Fields:** `Member Name`, `Member Phone`, `Join Date` (defaults to today), `Email`. Name and Phone are mandatory.
    * **SAVE Button Logic:** Validates that `Member Phone` is unique in the `members` table before saving.
    * **CLEAR Button:** Resets all form fields.
* **Right Panel: View / Manage Members**
    * **Filters:** Text inputs for `Name` and `Phone`, and radio buttons for `Active`/`Inactive` status.
    * **Members List:** A table displays member records from the `members` table matching the filters.
    * **Selection & Actions:** When a user clicks a row, the member's details are displayed below the list. `EDIT` and `DELETE` buttons appear and function on the selected member.

**Plans Tab**
This tab follows the whiteboard design for plan management.

* **Left Panel: Create / Update Plan**
    * **Fields:** `Plan Name`, `Duration (days)`, `Default Amount`. All fields are mandatory.
    * **`display_name` Logic:** This field is automatically generated by concatenating `Plan Name` and `Duration (days)` and is not user-editable.
    * **SAVE Button Logic:** Validates that the generated `display_name` is unique in the `plans` table before saving.
    * **CLEAR Button:** Resets all form fields.
* **Right Panel: View / Manage Plans**
    * **Filters:** Radio buttons for `Active`/`Inactive` status.
    * **Plan List:** A table displays plan records from the `plans` table matching the filters.
    * **Selection & Actions:** When a user clicks a row, the plan's details are displayed below the list. `EDIT` and `DELETE` buttons appear and function on the selected plan.

**Memberships Tab**
This tab is for creating and viewing the transactional history of memberships.

* **Functionality:** To create a new membership, the user will first select a member from the `Members Tab`. A **"Create Membership"** button will be available for the selected member.
* **Create Membership Form:**
    * **Plan Name:** A dropdown list of all active plans.
    * **Duration (Days):** Auto-filled from the selected plan, but user-editable.
    * **Amount:** Auto-filled from the plan's `default_amount`, but user-editable.
    * **Start Date:** A date picker control.
    * **SAVE Button Logic:**
        1.  Calculates `end_date` from `start_date` + `Duration`.
        2.  Creates one new row in the `memberships` table.
* **View Memberships:** This tab will also display a full, filterable list of all records in the `memberships` table.

**Reporting Tab**
This functionality is retained exactly from the previous specification.

* **Financial Report:**
    * **Logic:** Allows user to select a date range. It will query the `memberships` table, summing the `amount_paid` for all records where the **`purchase_date`** falls within that range. It generates a summary and an Excel download.
* **Renewals Report:**
    * **Logic:** Lists all active memberships (`is_active = True`) from the `memberships` table where the **`end_date`** is within the next 30 days.
